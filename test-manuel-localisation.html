<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Manuel - Syst√®me de Localisation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-item {
            margin: 10px 0;
            padding: 10px;
            border-left: 4px solid #ddd;
        }
        .test-item.passed {
            border-left-color: #4CAF50;
            background: #f8fff8;
        }
        .test-item.failed {
            border-left-color: #f44336;
            background: #fff8f8;
        }
        .test-item.pending {
            border-left-color: #ff9800;
            background: #fff8f0;
        }
        button {
            background: #ff6b35;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #e55a2b;
        }
        .status {
            font-weight: bold;
        }
        .instructions {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h1>üß™ Test Manuel - Syst√®me de Localisation</h1>
    
    <div class="instructions">
        <h3>üìã Instructions :</h3>
        <ol>
            <li>Ouvre <a href="http://localhost:3003" target="_blank">http://localhost:3003</a> dans un autre onglet</li>
            <li>Ouvre la console d√©veloppeur (F12)</li>
            <li>Clique sur les boutons de test ci-dessous</li>
            <li>V√©rifie les r√©sultats dans la console et sur la page</li>
        </ol>
    </div>

    <div class="test-section">
        <h2>üìç Test 1 : Badge de Localisation</h2>
        <div class="test-item pending" id="test1">
            <strong>V√©rifier la pr√©sence du badge</strong>
            <button onclick="testBadgePresence()">Tester</button>
            <div class="result" id="result1"></div>
        </div>
    </div>

    <div class="test-section">
        <h2>üîΩ Test 2 : Dropdown</h2>
        <div class="test-item pending" id="test2">
            <strong>Ouvrir/Fermer le dropdown</strong>
            <button onclick="testDropdownToggle()">Tester</button>
            <div class="result" id="result2"></div>
        </div>
    </div>

    <div class="test-section">
        <h2>üîç Test 3 : Recherche de Villes</h2>
        <div class="test-item pending" id="test3">
            <strong>Rechercher une ville</strong>
            <button onclick="testCitySearch()">Tester</button>
            <div class="result" id="result3"></div>
        </div>
    </div>

    <div class="test-section">
        <h2>üìè Test 4 : Changement de Rayon</h2>
        <div class="test-item pending" id="test4">
            <strong>Changer le rayon de recherche</strong>
            <button onclick="testRadiusChange()">Tester</button>
            <div class="result" id="result4"></div>
        </div>
    </div>

    <div class="test-section">
        <h2>üõ∞Ô∏è Test 5 : D√©tection GPS</h2>
        <div class="test-item pending" id="test5">
            <strong>Bouton de d√©tection GPS</strong>
            <button onclick="testGPSButton()">Tester</button>
            <div class="result" id="result5"></div>
        </div>
    </div>

    <div class="test-section">
        <h2>üíæ Test 6 : Persistance</h2>
        <div class="test-item pending" id="test6">
            <strong>V√©rifier la sauvegarde localStorage</strong>
            <button onclick="testLocalStorage()">Tester</button>
            <div class="result" id="result6"></div>
        </div>
    </div>

    <div class="test-section">
        <h2>üîó Test 7 : Int√©gration</h2>
        <div class="test-item pending" id="test7">
            <strong>V√©rifier l'int√©gration avec les composants</strong>
            <button onclick="testIntegration()">Tester</button>
            <div class="result" id="result7"></div>
        </div>
    </div>

    <div class="test-section">
        <h2>üéØ Test Complet</h2>
        <button onclick="runAllTests()" style="background: #4CAF50; font-size: 16px; padding: 15px 30px;">
            üöÄ Lancer Tous les Tests
        </button>
        <div class="result" id="resultAll"></div>
    </div>

    <script>
        // Fonctions de test
        function testBadgePresence() {
            try {
                // Ouvrir la page dans un iframe pour les tests
                const iframe = document.createElement('iframe');
                iframe.src = 'http://localhost:3003';
                iframe.style.display = 'none';
                document.body.appendChild(iframe);
                
                iframe.onload = () => {
                    try {
                        const badge = iframe.contentDocument.querySelector('[title="Changer de localisation"]');
                        if (badge) {
                            updateTestResult('test1', 'passed', '‚úÖ Badge trouv√© : ' + badge.textContent.trim());
                        } else {
                            updateTestResult('test1', 'failed', '‚ùå Badge non trouv√©');
                        }
                    } catch (e) {
                        updateTestResult('test1', 'failed', '‚ùå Erreur : ' + e.message);
                    }
                    document.body.removeChild(iframe);
                };
            } catch (e) {
                updateTestResult('test1', 'failed', '‚ùå Erreur : ' + e.message);
            }
        }

        function testDropdownToggle() {
            updateTestResult('test2', 'pending', '‚è≥ Test en cours...');
            
            // Instructions pour l'utilisateur
            const instructions = `
                <strong>Instructions :</strong><br>
                1. Clique sur le badge "Dijon ‚Ä¢ Rayon 20km" dans le header<br>
                2. V√©rifie que le dropdown s'ouvre<br>
                3. Clique √† nouveau sur le badge<br>
                4. V√©rifie que le dropdown se ferme<br>
                <br>
                <strong>R√©sultat attendu :</strong> Le dropdown doit s'ouvrir/fermer au clic sur le badge
            `;
            
            updateTestResult('test2', 'pending', instructions);
        }

        function testCitySearch() {
            const instructions = `
                <strong>Instructions :</strong><br>
                1. Ouvre le dropdown de localisation<br>
                2. Dans l'onglet "Recherche", tape "Paris" dans le champ<br>
                3. V√©rifie que les villes sont filtr√©es<br>
                <br>
                <strong>R√©sultat attendu :</strong> La recherche doit filtrer les villes
            `;
            
            updateTestResult('test3', 'pending', instructions);
        }

        function testRadiusChange() {
            const instructions = `
                <strong>Instructions :</strong><br>
                1. Ouvre le dropdown de localisation<br>
                2. Clique sur "50km" dans les options de rayon<br>
                3. S√©lectionne une ville<br>
                4. V√©rifie que le rayon a chang√© dans le badge<br>
                <br>
                <strong>R√©sultat attendu :</strong> Le rayon doit changer et √™tre persistant
            `;
            
            updateTestResult('test4', 'pending', instructions);
        }

        function testGPSButton() {
            const instructions = `
                <strong>Instructions :</strong><br>
                1. Ouvre le dropdown de localisation<br>
                2. Clique sur "Ma position"<br>
                3. Accepte la demande de g√©olocalisation si elle appara√Æt<br>
                <br>
                <strong>R√©sultat attendu :</strong> Le bouton GPS doit √™tre fonctionnel
            `;
            
            updateTestResult('test5', 'pending', instructions);
        }

        function testLocalStorage() {
            try {
                const data = localStorage.getItem('location-preferences');
                if (data) {
                    const parsed = JSON.parse(data);
                    updateTestResult('test6', 'passed', '‚úÖ Donn√©es localStorage trouv√©es : ' + JSON.stringify(parsed, null, 2));
                } else {
                    updateTestResult('test6', 'pending', '‚ÑπÔ∏è Aucune donn√©e localStorage (normal si premi√®re visite)');
                }
            } catch (e) {
                updateTestResult('test6', 'failed', '‚ùå Erreur localStorage : ' + e.message);
            }
        }

        function testIntegration() {
            const instructions = `
                <strong>Instructions :</strong><br>
                1. Change de ville via le dropdown<br>
                2. V√©rifie que les sections "√âv√©nements" et "Bons Plans" se mettent √† jour<br>
                3. V√©rifie que les indicateurs de localisation apparaissent<br>
                <br>
                <strong>R√©sultat attendu :</strong> Les composants doivent r√©agir au changement de ville
            `;
            
            updateTestResult('test7', 'pending', instructions);
        }

        function runAllTests() {
            updateTestResult('resultAll', 'pending', 'üöÄ Lancement de tous les tests...');
            
            // Ex√©cuter tous les tests
            testBadgePresence();
            testDropdownToggle();
            testCitySearch();
            testRadiusChange();
            testGPSButton();
            testLocalStorage();
            testIntegration();
            
            setTimeout(() => {
                updateTestResult('resultAll', 'passed', '‚úÖ Tous les tests ont √©t√© lanc√©s. V√©rifiez les r√©sultats individuels ci-dessus.');
            }, 1000);
        }

        function updateTestResult(testId, status, message) {
            const testElement = document.getElementById(testId);
            const resultElement = document.getElementById('result' + testId.replace('test', ''));
            
            if (testElement) {
                testElement.className = 'test-item ' + status;
            }
            
            if (resultElement) {
                resultElement.className = 'result ' + (status === 'passed' ? 'success' : status === 'failed' ? 'error' : '');
                resultElement.innerHTML = message;
            }
        }

        // Test automatique au chargement
        window.onload = () => {
            console.log('üß™ Page de test charg√©e. Pr√™t pour les tests manuels.');
        };
    </script>
</body>
</html>
