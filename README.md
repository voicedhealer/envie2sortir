# Envie2Sortir - Plateforme Ultra-Locale de Divertissements

Une plateforme moderne et intuitive pour d√©couvrir tous les √©tablissements de divertissement pr√®s de chez vous.

### üè† Page d'Accueil Ultra-Performante
- **Hero Section** avec gradient orange-pink-rouge et slogan accrocheur
- **Barre de recherche intelligente** avec double input (ville + activit√©)
- **Effet typewriter** pour les suggestions d'activit√©s
- **G√©olocalisation** "Autour de moi" avec consentement utilisateur
- **Dropdowns dynamiques** pour villes et cat√©gories d'activit√©s
- **Sections visuelles** : meilleurs endroits, cat√©gories, comment √ßa marche
- **Social Proof** avec t√©moignages utilisateurs
- **Section Pro** avec CTA pour r√©f√©rencer
- **Newsletter** et g√©olocalisation
- **Footer complet** avec liens et informations

### üîç Syst√®me de Recherche Avanc√©
- **Recherche par ville** avec suggestions automatiques
- **Recherche par cat√©gorie** li√©e √† la base de donn√©es
- **G√©olocalisation** pr√©cise avec rayon de 5km
- **Filtres intelligents** : Populaire, D√©sir√©s ++, Les - cher, Notre s√©lection, Nouveaux, Mieux not√©s
- **Pagination infinie** avec syst√®me "Voir plus" (15 r√©sultats par page)
- **Page de r√©sultats** avec grille de cartes + carte interactive
- **Recherche "envie"** avec extraction de mots-cl√©s intelligente
- **Filtre "Notre s√©lection"** : √âtablissements premium uniquement

### üó∫Ô∏è Carte Interactive
- **Int√©gration Leaflet.js** pour la cartographie
- **Marqueurs personnalis√©s** avec ic√¥ne bleu distinctive
- **Popups adaptatifs** selon le contexte (accueil vs d√©tail)
- **Centrage automatique** sur la zone de recherche
- **Marqueur de recherche** avec point central orange
- **Liens directs** vers les pages de d√©tails

### üè¢ Gestion des √âtablissements
- **CRUD complet** : Cr√©ation, Lecture, Mise √† jour, Suppression
- **Formulaires intelligents** avec validation client et serveur
- **G√©n√©ration automatique** de slugs SEO-friendly
- **Gestion des images** avec image principale
- **Syst√®me d'activit√©s √©tendu** : VR, escape game, bowling, restaurant, bar, etc.
- **Enrichissement automatique** via Google Places API
- **Donn√©es hybrides** : automatiques + manuelles

### üîê Syst√®me d'Authentification
- **NextAuth.js** avec support multi-providers
- **Connexion par email/mot de passe**
- **Connexion sociale** (Google, Facebook) - optionnelle
- **R√¥les utilisateurs** : Admin, Professionnel, Utilisateur
- **Architecture coh√©rente** : User (utilisateurs finaux) ‚Üî Professional (propri√©taires) ‚Üî Establishment
- **Protection des routes** avec middleware
- **Gestion des sessions** avec hydratation optimis√©e

### üë• Espaces Utilisateurs
- **Espace Professionnel** : Dashboard complet pour g√©rer son √©tablissement
- **Espace Admin** : Gestion globale de la plateforme
- **Mon Compte** : Profil utilisateur avec favoris
- **Inscription simplifi√©e** : Cr√©ation compte + √©tablissement en une √©tape

### üéØ Cat√©gories d'Activit√©s Avanc√©es
- **Syst√®me d'activit√©s d√©taill√©** avec 50+ cat√©gories
- **Mapping intelligent** des activit√©s vers des labels courts
- **Support multi-activit√©s** pour les √©tablissements complexes
- **Filtrage dynamique** par ville et activit√©
- **Recherche s√©mantique** avec mots-cl√©s

### üìÖ Syst√®me d'√âv√©nements
- **Gestion compl√®te** des √©v√©nements par √©tablissement
- **Filtrage temporel** : √©v√©nements √† venir uniquement
- **Affichage contextuel** : en cours vs √† venir
- **Interface intuitive** avec cartes √©v√©nements

### üé® Design System Responsive
- **Largeur adaptative** : max-w-6xl pour les √©crans larges
- **Popups contextuels** : tailles ajustables selon l'usage
- **Syst√®me de r√©glages** facile pour les tailles de composants
- **Layout optimis√©** pour tous les √©crans (13" √† 27"+)

## üõ†Ô∏è Technologies Utilis√©es

- **Frontend** : Next.js 15, React 19, TypeScript
- **Styling** : Tailwind CSS 4 avec th√®me personnalis√©
- **Base de donn√©es** : SQLite avec Prisma ORM
- **Cartographie** : Leaflet.js
- **Authentification** : NextAuth.js
- **G√©olocalisation** : API Web Geolocation + Nominatim
- **Enrichissement** : Google Places API
- **D√©ploiement** : Pr√™t pour Vercel/Netlify

## üèóÔ∏è Architecture du Syst√®me

### Diagramme de Classes UML - Backend

```mermaid
classDiagram
    %% ===== CLASSES DE SERVICE PRINCIPALES =====
    
    class EstablishmentEnrichment {
        -String apiKey
        -EnrichmentData enrichmentData
        -String establishmentType
        
        +triggerGoogleEnrichment(googleUrl) Promise~EnrichmentData~
        -fetchGooglePlaceData(placeId, placeName) Promise~Object~
        -parseGooglePlaceData(placeData) EnrichmentData
        -generateEnvieTags(placeData) String[]
        -extractSpecialties(placeData) String[]
        -determineAtmosphere(placeData) String[]
        -extractAccessibilityInfo(placeData) AccessibilityInfo
        -extractPaymentMethods(placeData) String[]
        -extractServices(placeData) String[]
        -extractClienteleInfo(placeData) ClienteleInfo
        -extractChildrenServices(placeData) String[]
        -determinePriceLevel(placeData) Number
        -extractBusinessHours(placeData) Object
        -extractContactInfo(placeData) Object
        -extractSocialMedia(placeData) Object
        -extractImages(placeData) String[]
        -extractReviews(placeData) Object[]
        -calculateEnrichmentScore(placeData) Number
        -validateEnrichmentData(data) Boolean
    }

    class AuthService {
        -PrismaClient prisma
        -String jwtSecret
        
        +signUp(firstName, lastName, email, password) Promise~User~
        +signIn(email, password) Promise~AuthResult~
        +getCurrentUser(request) Promise~User~
        +hashPassword(password) Promise~String~
        +validateCredentials(email, password) Promise~Boolean~
        +generateToken(user) String
        +verifyToken(token) Promise~User~
        +refreshToken(userId) String
        -sanitizeUserInput(input) String
        -validateEmailFormat(email) Boolean
        -checkPasswordStrength(password) Boolean
    }

    class EstablishmentService {
        -PrismaClient prisma
        -ValidationService validator
        -EnrichmentService enricher
        
        +createEstablishment(data) Promise~Establishment~
        +updateEstablishment(id, data) Promise~Establishment~
        +deleteEstablishment(id) Promise~Boolean~
        +getEstablishmentBySlug(slug) Promise~Establishment~
        +searchEstablishments(query) Promise~Establishment[]~
        +getEstablishmentsByLocation(lat, lng, radius) Promise~Establishment[]~
        +getEstablishmentsByCategory(category) Promise~Establishment[]~
        +getFeaturedEstablishments() Promise~Establishment[]~
        +incrementViews(establishmentId) Promise~void~
        +incrementClicks(establishmentId) Promise~void~
        -validateEstablishmentData(data) Boolean
        -generateSlug(name) String
        -sanitizeEstablishmentData(data) Object
        -checkSlugUniqueness(slug) Promise~Boolean~
    }

    class SearchService {
        -PrismaClient prisma
        -ScoringService scorer
        -GeocodingService geocoder
        
        +searchByEnvie(query, location, radius) Promise~SearchResult[]~
        +searchByFilters(filters) Promise~Establishment[]~
        +calculateThematicScore(query, establishment) Number
        +extractKeywords(query) String[]
        +applySorting(establishments, filter) Establishment[]
        +geocodeAddress(address) Promise~Coordinates~
        +reverseGeocode(lat, lng) Promise~Address~
        +getNearbyEstablishments(lat, lng, radius) Promise~Establishment[]~
        -normalizeQuery(query) String
        -removeStopWords(query) String
        -calculateDistance(lat1, lng1, lat2, lng2) Number
        -validateSearchParameters(params) Boolean
    }

    class ProfessionalService {
        -PrismaClient prisma
        -SubscriptionService subscriptionService
        
        +createProfessional(data) Promise~Professional~
        +updateProfessional(id, data) Promise~Professional~
        +getProfessionalDashboard(professionalId) Promise~DashboardData~
        +createEstablishment(professionalId, data) Promise~Establishment~
        +updateEstablishment(professionalId, establishmentId, data) Promise~Establishment~
        +getProfessionalEstablishments(professionalId) Promise~Establishment[]~
        +validateSiret(siret) Promise~Boolean~
        +checkSubscriptionAccess(professionalId, feature) Promise~Boolean~
        +upgradeSubscription(professionalId, plan) Promise~Boolean~
        -validateProfessionalData(data) Boolean
        -checkSiretUniqueness(siret) Promise~Boolean~
    }

    class EventService {
        -PrismaClient prisma
        -SubscriptionService subscriptionService
        
        +createEvent(establishmentId, data) Promise~Event~
        +updateEvent(eventId, data) Promise~Event~
        +deleteEvent(eventId) Promise~Boolean~
        +getEstablishmentEvents(establishmentId) Promise~Event[]~
        +getUpcomingEvents(establishmentId) Promise~Event[]~
        +getEventById(eventId) Promise~Event~
        +searchEvents(query) Promise~Event[]~
        -validateEventData(data) Boolean
        -checkEventConflicts(establishmentId, startDate, endDate) Promise~Boolean~
        -calculateEventDuration(startDate, endDate) Number
    }

    class ImageService {
        -FileStorageService storage
        -PrismaClient prisma
        -SubscriptionService subscriptionService
        
        +uploadImage(establishmentId, file) Promise~Image~
        +deleteImage(imageId) Promise~Boolean~
        +getEstablishmentImages(establishmentId) Promise~Image[]~
        +setPrimaryImage(establishmentId, imageId) Promise~Boolean~
        +reorderImages(establishmentId, imageIds) Promise~Boolean~
        +validateImageFile(file) Boolean
        +processImage(file) Promise~ProcessedImage~
        +generateThumbnail(image) Promise~String~
        -checkImageLimit(establishmentId) Promise~Boolean~
        -generateUniqueFilename(originalName) String
    }

    class SubscriptionService {
        -PrismaClient prisma
        
        +validateSubscriptionAccess(subscription, feature) ValidationResult
        +getSubscriptionFeatures(subscription) SubscriptionFeatures
        +upgradeSubscription(establishmentId, newPlan) Promise~Boolean~
        +downgradeSubscription(establishmentId, newPlan) Promise~Boolean~
        +getSubscriptionLimits(subscription) SubscriptionLimits
        +checkFeatureAccess(subscription, feature) Boolean
        +getPremiumRequiredError(feature) ErrorResponse
        -calculateUpgradePrice(currentPlan, newPlan) Number
        -validatePlanTransition(currentPlan, newPlan) Boolean
    }

    class ValidationService {
        +validateEstablishmentData(data) ValidationResult
        +validateUserData(data) ValidationResult
        +validateEventData(data) ValidationResult
        +validateImageFile(file) ValidationResult
        +sanitizeInput(input) String
        +sanitizeRequestBody(body) Object
        +validateEmail(email) Boolean
        +validatePhone(phone) Boolean
        +validateUrl(url) Boolean
        +validateCoordinates(lat, lng) Boolean
        -sanitizeString(input) String
        -validateRequiredFields(data, requiredFields) Boolean
    }

    class GeocodingService {
        -String apiKey
        
        +geocodeAddress(address) Promise~Coordinates~
        +reverseGeocode(lat, lng) Promise~Address~
        +validateAddress(address) Promise~Boolean~
        +getAddressComponents(address) Promise~AddressComponents~
        +calculateDistance(lat1, lng1, lat2, lng2) Number
        +getBoundingBox(lat, lng, radius) BoundingBox
        -callGeocodingAPI(address) Promise~Object~
        -parseGeocodingResponse(response) Coordinates
    }

    class GooglePlacesService {
        -String apiKey
        
        +fetchPlaceDetails(placeId) Promise~PlaceDetails~
        +searchPlaces(query, location) Promise~Place[]~
        +getPlacePhotos(placeId) Promise~String[]~
        +getPlaceReviews(placeId) Promise~Review[]~
        +resolveGoogleUrl(url) Promise~PlaceId~
        +validatePlaceId(placeId) Boolean
        -callGooglePlacesAPI(endpoint, params) Promise~Object~
        -parsePlaceDetails(response) PlaceDetails
        -parsePlaceSearch(response) Place[]
    }

    class FileStorageService {
        -String uploadPath
        -String[] allowedTypes
        -Number maxFileSize
        
        +uploadFile(file, path) Promise~String~
        +deleteFile(path) Promise~Boolean~
        +generateUrl(path) String
        +validateFileType(file) Boolean
        +validateFileSize(file) Boolean
        +generateUniquePath(originalName) String
        +createDirectory(path) Promise~Boolean~
        -sanitizeFileName(fileName) String
    }

    class ScoringService {
        +calculateThematicScore(query, establishment) Number
        +calculateRelevanceScore(query, establishment) Number
        +calculateDistanceScore(establishment, userLocation) Number
        +calculateRatingScore(establishment) Number
        +calculatePopularityScore(establishment) Number
        +extractKeywords(query) String[]
        +removeStopWords(keywords) String[]
        +calculateKeywordMatch(query, establishment) Number
        +calculateTagMatch(query, tags) Number
        -normalizeText(text) String
        -calculateTFIDF(term, document, documents) Number
    }

    %% ===== TYPES ET INTERFACES =====
    
    class EnrichmentData {
        +String name
        +String address
        +String phone
        +String website
        +String[] activities
        +String[] services
        +String[] ambiance
        +String[] paymentMethods
        +Object businessHours
        +String[] images
        +Number rating
        +Number reviewCount
        +String[] specialties
        +String[] atmosphere
        +AccessibilityInfo accessibility
        +String[] clienteleInfo
        +String[] childrenServices
        +Number priceLevel
        +Object contactInfo
        +Object socialMedia
        +Review[] reviews
        +String[] parking
    }

    class SearchResult {
        +Establishment establishment
        +Number score
        +Number distance
        +String[] matchedKeywords
        +String reason
    }

    class ValidationResult {
        +Boolean isValid
        +String[] errors
        +String[] warnings
    }

    class SubscriptionFeatures {
        +Number maxImages
        +Boolean canCreateEvents
        +Boolean canCreatePromotions
        +Boolean canAccessAnalytics
        +Boolean canCustomizeProfile
    }

    class Coordinates {
        +Number latitude
        +Number longitude
    }

    class Address {
        +String street
        +String city
        +String postalCode
        +String country
        +String formattedAddress
    }

    %% ===== RELATIONS ENTRE CLASSES =====
    
    EstablishmentService --> ValidationService : "utilise"
    EstablishmentService --> EstablishmentEnrichment : "utilise"
    SearchService --> ScoringService : "utilise"
    SearchService --> GeocodingService : "utilise"
    ProfessionalService --> SubscriptionService : "utilise"
    EventService --> SubscriptionService : "utilise"
    ImageService --> FileStorageService : "utilise"
    ImageService --> SubscriptionService : "utilise"
    EstablishmentEnrichment --> GooglePlacesService : "utilise"
    AuthService --> ValidationService : "utilise"
```

### Descriptions des Classes Principales

#### **EstablishmentEnrichment**
**Description** : Classe principale pour l'enrichissement automatique des √©tablissements via Google Places API.
- **Responsabilit√©s** : R√©cup√©ration, parsing et transformation des donn√©es Google Places
- **M√©thodes cl√©s** : `triggerGoogleEnrichment()`, `fetchGooglePlaceData()`, `parseGooglePlaceData()`
- **Donn√©es enrichies** : Activit√©s, services, ambiance, moyens de paiement, accessibilit√©, etc.

#### **AuthService**
**Description** : Service d'authentification et de gestion des utilisateurs.
- **Responsabilit√©s** : Inscription, connexion, validation des credentials, gestion des tokens
- **M√©thodes cl√©s** : `signUp()`, `signIn()`, `getCurrentUser()`, `hashPassword()`
- **S√©curit√©** : Hachage des mots de passe, validation des entr√©es, gestion des sessions

#### **EstablishmentService**
**Description** : Service de gestion des √©tablissements (CRUD, recherche, g√©olocalisation).
- **Responsabilit√©s** : Cr√©ation, modification, suppression, recherche d'√©tablissements
- **M√©thodes cl√©s** : `createEstablishment()`, `searchEstablishments()`, `getEstablishmentsByLocation()`
- **Fonctionnalit√©s** : G√©olocalisation, g√©n√©ration de slugs, statistiques de vues

#### **SearchService**
**Description** : Service de recherche intelligente avec scoring th√©matique.
- **Responsabilit√©s** : Recherche par "envie", filtrage, scoring, g√©olocalisation
- **M√©thodes cl√©s** : `searchByEnvie()`, `calculateThematicScore()`, `extractKeywords()`
- **Algorithme** : Scoring bas√© sur la pertinence th√©matique, distance, et popularit√©

#### **ProfessionalService**
**Description** : Service de gestion des professionnels et de leurs √©tablissements.
- **Responsabilit√©s** : Gestion des comptes professionnels, validation SIRET, abonnements
- **M√©thodes cl√©s** : `createProfessional()`, `validateSiret()`, `checkSubscriptionAccess()`
- **Validation** : V√©rification SIRET, gestion des abonnements FREE/PREMIUM

#### **EventService**
**Description** : Service de gestion des √©v√©nements des √©tablissements.
- **Responsabilit√©s** : Cr√©ation, modification, suppression d'√©v√©nements
- **M√©thodes cl√©s** : `createEvent()`, `getUpcomingEvents()`, `checkEventConflicts()`
- **Restrictions** : Acc√®s limit√© aux √©tablissements PREMIUM

#### **ImageService**
**Description** : Service de gestion des images et fichiers multim√©dias.
- **Responsabilit√©s** : Upload, suppression, r√©organisation des images
- **M√©thodes cl√©s** : `uploadImage()`, `setPrimaryImage()`, `reorderImages()`
- **Limites** : Gestion des quotas selon l'abonnement (1 image FREE, 10 PREMIUM)

#### **SubscriptionService**
**Description** : Service de gestion des abonnements et des fonctionnalit√©s.
- **Responsabilit√©s** : Validation des acc√®s, gestion des plans, limites de fonctionnalit√©s
- **M√©thodes cl√©s** : `validateSubscriptionAccess()`, `getSubscriptionFeatures()`
- **Plans** : STANDARD (gratuit) et PREMIUM (payant)

#### **ValidationService**
**Description** : Service de validation et de sanitisation des donn√©es.
- **Responsabilit√©s** : Validation des entr√©es, sanitisation, v√©rification des formats
- **M√©thodes cl√©s** : `validateEstablishmentData()`, `sanitizeInput()`, `validateEmail()`
- **S√©curit√©** : Protection contre les injections, validation des types

#### **GeocodingService**
**Description** : Service de g√©ocodage et de g√©olocalisation.
- **Responsabilit√©s** : Conversion adresse ‚Üî coordonn√©es, calculs de distance
- **M√©thodes cl√©s** : `geocodeAddress()`, `reverseGeocode()`, `calculateDistance()`
- **Int√©gration** : API de g√©ocodage externe

#### **GooglePlacesService**
**Description** : Service d'int√©gration avec Google Places API.
- **Responsabilit√©s** : R√©cup√©ration des donn√©es Google Places, r√©solution d'URLs
- **M√©thodes cl√©s** : `fetchPlaceDetails()`, `searchPlaces()`, `resolveGoogleUrl()`
- **Donn√©es** : D√©tails des lieux, photos, avis, informations de contact

#### **FileStorageService**
**Description** : Service de gestion des fichiers et du stockage.
- **Responsabilit√©s** : Upload, suppression, validation des fichiers
- **M√©thodes cl√©s** : `uploadFile()`, `deleteFile()`, `validateFileType()`
- **S√©curit√©** : Validation des types de fichiers, limitation de taille

#### **ScoringService**
**Description** : Service de calcul des scores de pertinence pour la recherche.
- **Responsabilit√©s** : Calcul des scores th√©matiques, de distance, de popularit√©
- **M√©thodes cl√©s** : `calculateThematicScore()`, `extractKeywords()`, `calculateRelevanceScore()`
- **Algorithme** : TF-IDF, matching de mots-cl√©s, scoring multi-crit√®res

### Flux de Donn√©es et Relations

```mermaid
flowchart TD
    A[Client Request] --> B[API Route]
    B --> C[Service Layer]
    C --> D[Validation Service]
    C --> E[Business Logic]
    E --> F[Data Access Layer]
    F --> G[Prisma ORM]
    G --> H[SQLite Database]
    
    C --> I[External Services]
    I --> J[Google Places API]
    I --> K[Geocoding API]
    I --> L[File Storage]
    
    C --> M[Authentication]
    M --> N[NextAuth.js]
    N --> O[JWT Tokens]
    
    C --> P[Subscription Check]
    P --> Q[Feature Access Control]
    
    R[Enrichment Process] --> S[Google Places Data]
    S --> T[Data Parsing]
    T --> U[Hybrid Data Management]
    U --> V[Database Update]
```

### Technologies et Patterns Utilis√©s

- **Architecture** : Service Layer Pattern, Repository Pattern
- **Validation** : Zod schemas, custom validation services
- **Authentification** : NextAuth.js, JWT tokens
- **Base de donn√©es** : Prisma ORM, SQLite
- **Services externes** : Google Places API, Geocoding services
- **S√©curit√©** : Input sanitization, SQL injection prevention
- **Performance** : Caching, pagination, lazy loading
- **Monitoring** : Request logging, error tracking

### Architecture G√©n√©rale du Syst√®me

```mermaid
graph TB
    %% Frontend Layer
    subgraph "Frontend (Next.js 15 + React 19)"
        UI[Interface Utilisateur]
        Pages[Pages Next.js]
        Components[Composants React]
        Auth[NextAuth.js]
        Maps[React Leaflet]
    end

    %% Backend Layer
    subgraph "Backend (Next.js API Routes)"
        API[API Routes]
        AuthAPI[Auth Routes]
        SearchAPI[Recherche API]
        EstabAPI[√âtablissements API]
        UploadAPI[Upload API]
        AdminAPI[Admin API]
    end

    %% Database Layer
    subgraph "Base de Donn√©es (SQLite + Prisma)"
        DB[(SQLite Database)]
        Prisma[Prisma ORM]
        Models[Mod√®les de donn√©es]
    end

    %% External Services
    subgraph "Services Externes"
        GooglePlaces[Google Places API]
        GoogleMaps[Google Maps]
        SIRET[SIRET API]
        TheFork[TheFork]
        UberEats[Uber Eats]
    end

    %% File Storage
    subgraph "Stockage Fichiers"
        LocalStorage[Stockage Local]
        Uploads[Uploads Directory]
    end

    %% Data Flow
    UI --> Pages
    Pages --> Components
    Components --> API
    Auth --> AuthAPI
    
    API --> Prisma
    Prisma --> DB
    Models --> DB
    
    SearchAPI --> GooglePlaces
    EstabAPI --> GooglePlaces
    EstabAPI --> SIRET
    
    UploadAPI --> LocalStorage
    LocalStorage --> Uploads
    
    GooglePlaces --> GoogleMaps
    EstabAPI --> TheFork
    EstabAPI --> UberEats

    %% Styling
    classDef frontend fill:#ff751f,stroke:#333,stroke-width:2px,color:#fff
    classDef backend fill:#ff1fa9,stroke:#333,stroke-width:2px,color:#fff
    classDef database fill:#ff3a3a,stroke:#333,stroke-width:2px,color:#fff
    classDef external fill:#4CAF50,stroke:#333,stroke-width:2px,color:#fff
    classDef storage fill:#2196F3,stroke:#333,stroke-width:2px,color:#fff

    class UI,Pages,Components,Auth,Maps frontend
    class API,AuthAPI,SearchAPI,EstabAPI,UploadAPI,AdminAPI backend
    class DB,Prisma,Models database
    class GooglePlaces,GoogleMaps,SIRET,TheFork,UberEats external
    class LocalStorage,Uploads storage
```

### Description de l'Architecture

#### üé® **Frontend (Next.js 15 + React 19)**
- **Interface Utilisateur** : Interface moderne avec Tailwind CSS utilisant la palette de couleurs orange-pink-rouge
- **Pages Next.js** : Pages statiques et dynamiques pour la navigation
- **Composants React** : Composants r√©utilisables (cartes d'√©tablissements, formulaires, etc.)
- **NextAuth.js** : Authentification avec support Google/Facebook et credentials
- **React Leaflet** : Cartes interactives pour la g√©olocalisation

#### ‚öôÔ∏è **Backend (Next.js API Routes)**
- **API Routes** : 44 endpoints API organis√©s par fonctionnalit√©
- **Auth Routes** : Gestion de l'authentification et des sessions
- **Recherche API** : Recherche intelligente avec filtres et g√©olocalisation
- **√âtablissements API** : CRUD des √©tablissements avec enrichissement automatique
- **Upload API** : Gestion des images et fichiers
- **Admin API** : Administration et mod√©ration

#### üóÑÔ∏è **Base de Donn√©es (SQLite + Prisma)**
- **SQLite** : Base de donn√©es relationnelle pour le d√©veloppement
- **Prisma ORM** : Gestion des mod√®les et migrations
- **Mod√®les** : 15+ mod√®les (User, Establishment, Event, Comment, etc.)

#### üåê **Services Externes**
- **Google Places API** : Enrichissement automatique des √©tablissements
- **Google Maps** : G√©olocalisation et cartes
- **API SIRET** : V√©rification des professionnels
- **TheFork** : Int√©gration r√©servations restaurants
- **Uber Eats** : Liens de livraison

#### üìÅ **Stockage Fichiers**
- **Stockage Local** : Images et fichiers upload√©s
- **Uploads Directory** : Dossier public pour les m√©dias

### Flux de Donn√©es Principaux

1. **Recherche d'√âtablissements** : `Utilisateur ‚Üí Interface ‚Üí API Recherche ‚Üí Prisma ‚Üí SQLite + Google Places`
2. **Authentification** : `Utilisateur ‚Üí NextAuth ‚Üí Auth API ‚Üí Prisma ‚Üí SQLite + OAuth`
3. **Cr√©ation d'√âtablissement** : `Professionnel ‚Üí Formulaire ‚Üí API √âtablissements ‚Üí Prisma ‚Üí SQLite + Google Places`
4. **Upload d'Images** : `Utilisateur ‚Üí Upload API ‚Üí Stockage Local ‚Üí Dossier Public`

## üé® Design System

### Couleurs Th√®me
- **Orange** : #ff751f
- **Pink** : #ff1fa9  
- **Rouge** : #ff3a3a
- **Fond** : Blanc (#ffffff)
- **Texte** : Noir (#171717)

### Typographie
- **Police principale** : Inter (Google Fonts)
- **Hi√©rarchie** : H1 (6xl), H2 (3xl), H3 (xl)
- **Responsive** : Mobile-first avec breakpoints Tailwind

### Composants
- **Cartes** avec gradients et effets hover
- **Boutons** avec d√©grad√©s et transitions
- **Formulaires** avec focus states et validation
- **Navigation** sticky avec logo et liens
- **Popups** adaptatifs selon le contexte

## üì± Responsive Design

- **Mobile-first** approche
- **Grilles adaptatives** (1 ‚Üí 2 ‚Üí 4 ‚Üí 6 colonnes)
- **Navigation mobile** optimis√©e
- **Cartes tactiles** pour mobile
- **Carte interactive** responsive
- **Largeur maximale** : 6xl pour les √©crans larges
- **Espacement optimis√©** pour tous les formats d'√©cran

## üóÑÔ∏è Structure de la Base de Donn√©es

### Architecture de la Base de Donn√©es

#### üèóÔ∏è **S√©paration des Responsabilit√©s**

**User (Utilisateurs Finaux)**
- üë• **R√¥le** : Utilisateurs finaux du site
- ‚úÖ **Peuvent** : chercher, liker, commenter, mettre en favoris
- ‚ùå **NE PEUVENT PAS** : cr√©er/g√©rer des √©tablissements
- üîó **Relations** : UserComment, UserFavorite, UserLike

**Professional (Propri√©taires d'√âtablissements)**
- üè¢ **R√¥le** : Propri√©taires d'√©tablissements
- ‚úÖ **Seuls autoris√©s** √† cr√©er/g√©rer des √©tablissements
- üîç **V√©rification obligatoire** via SIRET
- üîó **Relation 1:1** avec Establishment

**Establishment (√âtablissements)**
- üè™ **R√¥le** : √âtablissements de sortie
- üë®‚Äçüíº **Cr√©√©s et g√©r√©s** uniquement par des Professionals
- ‚úÖ **Syst√®me de validation** par l'admin avant publication
- üîó **Propri√©taire** : Professional (relation 1:1 avec @unique)

### Diagramme Entit√©-Relation (ER) - Architecture Unifi√©e

```mermaid
erDiagram
    %% ENTIT√âS PRINCIPALES
    User {
        string id PK
        string email UK
        string passwordHash
        string firstName
        string lastName
        string name
        string phone
        json preferences
        boolean newsletterOptIn
        string provider
        string providerId
        string avatar
        boolean isVerified
        string favoriteCity
        enum role "user|admin"
        datetime createdAt
        datetime updatedAt
    }

    Professional {
        string id PK
        string siret UK
        string firstName
        string lastName
        string email UK
        string passwordHash
        string phone
        string companyName
        string legalStatus
        enum subscriptionPlan "FREE|PREMIUM"
        boolean siretVerified
        datetime siretVerifiedAt
        datetime createdAt
        datetime updatedAt
    }

    Establishment {
        string id PK
        string name
        string slug UK
        string description
        string address
        string city
        string postalCode
        string country
        float latitude
        float longitude
        string phone
        string email
        string website
        string instagram
        string facebook
        json activities
        string specialites
        string motsClesRecherche
        json services
        json ambiance
        json paymentMethods
        json horairesOuverture
        float prixMoyen
        int capaciteMax
        boolean accessibilite
        boolean parking
        boolean terrasse
        enum status "pending|approved|rejected"
        enum subscription "FREE|STANDARD|PREMIUM"
        string ownerId FK
        int viewsCount
        int clicksCount
        float avgRating
        int totalComments
        datetime createdAt
        datetime updatedAt
        string tiktok
        string imageUrl
        float priceMax
        float priceMin
        json informationsPratiques
        string googlePlaceId
        string googleBusinessUrl
        boolean enriched
        json enrichmentData
        json envieTags
        int priceLevel
        float googleRating
        int googleReviewCount
        string theForkLink
        string uberEatsLink
        json specialties
        json atmosphere
        json accessibility
        json accessibilityDetails
        json detailedServices
        json clienteleInfo
        json detailedPayments
        json childrenServices
    }

    %% ENTIT√âS DE RELATION
    UserComment {
        string id PK
        string content
        int rating
        string userId FK
        string establishmentId FK
        datetime createdAt
        datetime updatedAt
    }

    UserFavorite {
        string id PK
        string userId FK
        string establishmentId FK
        datetime createdAt
    }

    UserLike {
        string id PK
        string userId FK
        string establishmentId FK
        datetime createdAt
    }

    EtablissementTag {
        string id PK
        string etablissementId FK
        string tag
        string typeTag
        int poids
        datetime createdAt
    }

    Event {
        string id PK
        string title
        string description
        string imageUrl
        string establishmentId FK
        datetime startDate
        datetime endDate
        float price
        int maxCapacity
        boolean isRecurring
        datetime createdAt
        datetime updatedAt
    }

    FeaturedPromotion {
        string id PK
        string title
        string description
        string establishmentId FK
        datetime startDate
        datetime endDate
        float discount
        datetime createdAt
        datetime updatedAt
    }

    Image {
        string id PK
        string url
        string altText
        boolean isPrimary
        int ordre
        string establishmentId FK
        datetime createdAt
    }

    Pricing {
        string id PK
        string name
        string description
        float price
        string establishmentId FK
        datetime createdAt
        datetime updatedAt
    }

    Tariff {
        string id PK
        string name
        string description
        float price
        string establishmentId FK
        datetime createdAt
        datetime updatedAt
    }

    %% RELATIONS PRINCIPALES
    Professional ||--o| Establishment : "poss√®de (1:1)"
    Professional {
        string id PK
    }
    Establishment {
        string ownerId FK
    }

    %% RELATIONS UTILISATEURS
    User ||--o{ UserComment : "√©crit"
    User ||--o{ UserFavorite : "favorise"
    User ||--o{ UserLike : "aime"

    %% RELATIONS √âTABLISSEMENTS
    Establishment ||--o{ UserComment : "re√ßoit"
    Establishment ||--o{ UserFavorite : "est favoris√©"
    Establishment ||--o{ UserLike : "est aim√©"
    Establishment ||--o{ EtablissementTag : "a des tags"
    Establishment ||--o{ Event : "organise"
    Establishment ||--o{ FeaturedPromotion : "propose"
    Establishment ||--o{ Image : "a des images"
    Establishment ||--o{ Pricing : "a des tarifs"
    Establishment ||--o{ Tariff : "a des forfaits"
```

### üèóÔ∏è **Points Cl√©s de l'Architecture Unifi√©e**

#### **1. S√âPARATION CLAIRE DES R√îLES :**
- **`User`** : Clients simples (consultation, commentaires, favoris)
- **`Professional`** : Propri√©taires d'√©tablissements (cr√©ation, gestion)

#### **2. RELATION 1:1 OBLIGATOIRE :**
- **`Professional` ‚Üî `Establishment`** : Un professionnel = Un √©tablissement maximum
- **`ownerId`** : Cl√© √©trang√®re directe vers `Professional.id`

#### **3. SYST√àME D'AUTHENTIFICATION UNIFI√â :**
- **NextAuth** g√®re les deux types via `userType`
- **Recherche automatique** dans les deux tables lors de la connexion

#### **4. VALIDATION ET S√âCURIT√â :**
- **SIRET obligatoire** pour les professionnels
- **Statut d'√©tablissement** : `pending` ‚Üí `approved` ‚Üí `rejected`
- **V√©rification admin** avant publication

#### **5. FONCTIONNALIT√âS UTILISATEURS :**
- **Commentaires** : `User` ‚Üí `Establishment`
- **Favoris** : `User` ‚Üí `Establishment` (relation unique)
- **Likes** : `User` ‚Üí `Establishment` (relation unique)

Cette architecture garantit une s√©paration claire des responsabilit√©s tout en maintenant une coh√©rence dans le syst√®me d'authentification ! üöÄ

### Mod√®les Principaux - Architecture Coh√©rente

#### User (Utilisateurs Finaux)
```prisma
model User {
  id              String   @id @default(cuid())
  email           String   @unique
  firstName       String?
  lastName        String?
  role            UserRole @default(user)
  favoriteCity    String?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  // Relations
  comments        UserComment[]
  favorites       UserFavorite[]
  likes           UserLike[]
}
```

#### Professional (Propri√©taires d'√âtablissements)
```prisma
model Professional {
  id               String           @id @default(cuid())
  siret            String           @unique
  firstName        String
  lastName         String
  email            String           @unique
  phone            String
  companyName      String
  legalStatus      String
  subscriptionPlan SubscriptionPlan @default(FREE)
  siretVerified    Boolean          @default(false)
  siretVerifiedAt  DateTime?
  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt
  
  // Relations
  establishment    Establishment?   // Relation 1:1
}
```

#### Establishment (√âtablissements)
```prisma
model Establishment {
  id                    String   @id @default(cuid())
  name                  String
  slug                  String   @unique
  description           String?
  address               String
  city                  String?
  postalCode            String?
  country               String   @default("France")
  latitude              Float?
  longitude             Float?
  phone                 String?
  email                 String?
  website               String?
  instagram             String?
  facebook              String?
  tiktok                String?
  activities            Json?    // Syst√®me d'activit√©s √©tendu
  specialites           String   @default("")
  motsClesRecherche     String?
  services              Json?    // Services organis√©s
  ambiance              Json?    // Ambiance organis√©e
  paymentMethods        Json?    // Moyens de paiement
  horairesOuverture     Json?    // Horaires
  prixMoyen             Float?
  capaciteMax           Int?
  accessibilite         Boolean  @default(false)
  parking               Boolean  @default(false)
  terrasse              Boolean  @default(false)
  status                EstablishmentStatus @default(pending)
  subscription          SubscriptionType    @default(STANDARD)
  ownerId               String   @unique    // FK vers Professional
  owner                 Professional @relation(fields: [ownerId], references: [id])
  viewsCount            Int      @default(0)
  clicksCount           Int      @default(0)
  avgRating             Float?
  totalComments         Int      @default(0)
  imageUrl              String?
  priceMax              Float?
  priceMin              Float?
  informationsPratiques Json?
  googlePlaceId         String?
  googleBusinessUrl     String?
  enriched              Boolean  @default(false)
  enrichmentData        Json?
  envieTags             String[]
  priceLevel            Int?
  googleRating          Float?
  googleReviewCount     Int?
  theForkLink           String?
  uberEatsLink          String?
  specialties           String[]
  atmosphere            String[]
  accessibility         String[]
  accessibilityDetails  Json?
  detailedServices      Json?
  clienteleInfo         String?
  detailedPayments      Json?
  childrenServices      Json?
  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt
  tags                  Tag[]
  events                Event[]
  featuredPromotions    Promotion[]
  images                Image[]
  pricing               Pricing[]
  tariffs               Tariff[]
  comments              Comment[]
  favorites             Favorite[]
  likes                 Like[]
}

model Event {
  id             String   @id @default(cuid())
  title          String
  description    String?
  startDate      DateTime
  endDate        DateTime?
  price          Float?
  maxCapacity    Int?
  establishmentId String
  establishment  Establishment @relation(fields: [establishmentId], references: [id])
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
}

enum UserRole {
  ADMIN
  PROFESSIONAL
  USER
}

enum EstablishmentStatus {
  DRAFT
  PENDING
  APPROVED
  REJECTED
  SUSPENDED
}

enum SubscriptionType {
  FREE
  BASIC
  PREMIUM
  ENTERPRISE
}
```
## üìä Diagrammes de S√©quence - Interactions Critiques

### 1. üîê Connexion Utilisateur (Authentification)

```mermaid
sequenceDiagram
    participant U as Utilisateur
    participant F as Frontend (React)
    participant A as NextAuth API
    participant D as Database (Prisma)
    participant S as Session Store

    U->>F: 1. Acc√®de √† /auth
    F->>U: 2. Affiche formulaire de connexion
    
    U->>F: 3. Saisit email + mot de passe
    F->>A: 4. POST /api/auth/signin
    A->>D: 5. SELECT user WHERE email = ?
    D-->>A: 6. Retourne utilisateur + hash
    
    A->>A: 7. V√©rifie mot de passe (bcrypt)
    alt Mot de passe correct
        A->>S: 8. Cr√©e session JWT
        S-->>A: 9. Token de session
        A-->>F: 10. Succ√®s + redirection
        F->>U: 11. Redirige vers dashboard
    else Mot de passe incorrect
        A-->>F: 12. Erreur d'authentification
        F->>U: 13. Affiche message d'erreur
    end
```

### 2. üîç Recherche d'√âtablissements (Cas Principal)

```mermaid
sequenceDiagram
    participant U as Utilisateur
    participant F as Frontend (React)
    participant A as API /recherche
    participant D as Database (Prisma)
    participant G as Google Places API
    participant M as Map Component

    U->>F: 1. Saisit ville + activit√©
    F->>A: 2. POST /api/recherche/filtered
    A->>D: 3. SELECT establishments WHERE city = ? AND activities LIKE ?
    D-->>A: 4. Liste des √©tablissements
    
    A->>A: 5. Calcul distances + filtres
    A->>G: 6. Enrichissement donn√©es (optionnel)
    G-->>A: 7. Donn√©es compl√©mentaires
    
    A-->>F: 8. R√©sultats pagin√©s (15/page)
    F->>M: 9. Affiche carte interactive
    F->>U: 10. Grille de cartes + carte
    
    U->>F: 11. Clique sur √©tablissement
    F->>U: 12. Redirige vers /etablissements/[slug]
```

### 3. üè¢ Cr√©ation d'√âtablissement (Professionnel)

```mermaid
sequenceDiagram
    participant P as Professionnel
    participant F as Frontend (React)
    participant A as API /etablissements
    participant D as Database (Prisma)
    participant G as Google Places API
    participant S as Storage (Images)

    P->>F: 1. Acc√®de √† /etablissements/nouveau
    F->>P: 2. Affiche formulaire multi-√©tapes
    
    P->>F: 3. Remplit informations de base
    F->>A: 4. POST /api/etablissements avec donn√©es
    A->>D: 5. INSERT INTO establishments
    D-->>A: 6. ID de l'√©tablissement cr√©√©
    
    P->>F: 7. Upload images
    F->>S: 8. POST /api/upload/image
    S-->>F: 9. URLs des images
    F->>A: 10. PUT /api/etablissements/images
    
    A->>G: 11. Enrichissement automatique
    G-->>A: 12. Donn√©es Google Places
    A->>D: 13. UPDATE establishment avec donn√©es enrichies
    
    A-->>F: 14. Succ√®s + slug g√©n√©r√©
    F->>P: 15. Redirige vers dashboard pro
```

### üìã R√©sum√© des Interactions Critiques

#### üîê Authentification (Cas 1)
- **Composants** : Frontend ‚Üí NextAuth ‚Üí Database ‚Üí Session Store
- **Points critiques** : V√©rification bcrypt, gestion JWT, protection des routes
- **S√©curit√©** : Hashage des mots de passe, tokens s√©curis√©s

#### üîç Recherche (Cas 2)
- **Composants** : Frontend ‚Üí API Recherche ‚Üí Database ‚Üí Google Places ‚Üí Map
- **Points critiques** : Filtrage intelligent, pagination, g√©olocalisation
- **Performance** : Requ√™tes optimis√©es, cache des r√©sultats

#### ÔøΩÔøΩ Cr√©ation √âtablissement (Cas 3)
- **Composants** : Frontend ‚Üí API CRUD ‚Üí Database ‚Üí Google Places ‚Üí Storage
- **Points critiques** : Validation multi-√©tapes, enrichissement automatique
- **UX** : Formulaire progressif, upload d'images, g√©n√©ration de slug

#### ÔøΩÔøΩ Points Techniques Cl√©s

**Architecture des Interactions :**
1. **Frontend React** : Interface utilisateur et gestion d'√©tat
2. **API Next.js** : Logique m√©tier et validation
3. **Database Prisma** : Persistance des donn√©es
4. **Services externes** : Google Places, Storage, Auth

**Flux de Donn√©es :**
- **Synchronisation** : Session ‚Üî Database ‚Üî Frontend
- **Validation** : Client-side + Server-side
- **Enrichissement** : Donn√©es automatiques + s√©lection manuelle des informations pertinentes
- **Performance** : Cache, pagination, requ√™tes optimis√©es

## üöÄ Installation et D√©marrage

### Pr√©requis
- Node.js 18+ 
- npm ou yarn
- Git

### Installation
```bash
# Cloner le projet
git clone https://github.com/voicedhealer/envie2sortir.git
cd envie2sortir

# Installer les d√©pendances
npm install

# Configurer la base de donn√©es
cp .env.example .env.local
# Modifier les variables dans .env.local

# G√©n√©rer le client Prisma
npx prisma generate

# Appliquer les migrations
npx prisma migrate dev

# D√©marrer le serveur de d√©veloppement
npm run dev
```

### Variables d'Environnement
```env
# Base de donn√©es
DATABASE_URL="file:./prisma/dev.db"

# NextAuth
NEXTAUTH_URL="http://localhost:3000"
NEXTAUTH_SECRET="your-secret-key"

# Google OAuth (optionnel)
GOOGLE_CLIENT_ID="your-google-client-id"
GOOGLE_CLIENT_SECRET="your-google-client-secret"

# Facebook OAuth (optionnel)
FACEBOOK_CLIENT_ID="your-facebook-client-id"
FACEBOOK_CLIENT_SECRET="your-facebook-client-secret"
```

## üìÅ Structure du Projet

```
src/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ api/                    # Routes API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin/              # API admin
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/               # Authentification
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ categories/         # API cat√©gories
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/          # API dashboard
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ establishments/     # CRUD √©tablissements
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ etablissements/     # API √©tablissements (FR)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ geocode/            # G√©ocodage
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ google-places-proxy/ # Proxy Google Places
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ professional/       # API professionnels
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ recherche/          # API recherche
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ upload/             # Upload d'images
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user/               # API utilisateurs
‚îÇ   ‚îú‚îÄ‚îÄ auth/                   # Pages d'authentification
‚îÇ   ‚îú‚îÄ‚îÄ carte/                  # Page carte interactive
‚îÇ   ‚îú‚îÄ‚îÄ dashboard/              # Dashboard professionnel
‚îÇ   ‚îú‚îÄ‚îÄ etablissements/         # Gestion √©tablissements
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ [slug]/            # Pages d√©tail √©tablissement
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ nouveau/           # Cr√©ation √©tablissement
‚îÇ   ‚îú‚îÄ‚îÄ mon-compte/            # Profil utilisateur
‚îÇ   ‚îú‚îÄ‚îÄ recherche/             # Page r√©sultats recherche
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ filtered/          # Page recherche filtr√©e
‚îÇ   ‚îú‚îÄ‚îÄ sections/              # Composants landing page
‚îÇ   ‚îú‚îÄ‚îÄ globals.css            # Styles globaux
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx             # Layout principal
‚îÇ   ‚îú‚îÄ‚îÄ navigation.tsx         # Navigation globale
‚îÇ   ‚îî‚îÄ‚îÄ page.tsx               # Page d'accueil
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ forms/                 # Formulaires
‚îÇ   ‚îú‚îÄ‚îÄ EstablishmentCard.tsx  # Carte √©tablissement
‚îÇ   ‚îú‚îÄ‚îÄ EstablishmentGrid.tsx  # Grille √©tablissements
‚îÇ   ‚îú‚îÄ‚îÄ EstablishmentHero.tsx  # Hero √©tablissement
‚îÇ   ‚îú‚îÄ‚îÄ EstablishmentSections.tsx # Sections d√©tail
‚îÇ   ‚îú‚îÄ‚îÄ UpcomingEventsSection.tsx # √âv√©nements √† venir
‚îÇ   ‚îú‚îÄ‚îÄ MapComponent.tsx       # Carte interactive
‚îÇ   ‚îú‚îÄ‚îÄ SearchFilters.tsx      # Filtres de recherche
‚îÇ   ‚îú‚îÄ‚îÄ LoadMoreButton.tsx     # Bouton "Voir plus"
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ auth-config.ts         # Configuration NextAuth
‚îÇ   ‚îú‚îÄ‚îÄ prisma.ts              # Client Prisma
‚îÇ   ‚îú‚îÄ‚îÄ date-utils.ts          # Utilitaires dates
‚îÇ   ‚îú‚îÄ‚îÄ enrichment-system.ts   # Syst√®me d'enrichissement
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ types/
    ‚îî‚îÄ‚îÄ next-auth.d.ts         # Types NextAuth
```

## üîß API Endpoints

### Authentification
- `POST /api/auth/register` - Inscription utilisateur
- `POST /api/auth/login` - Connexion utilisateur
- `GET /api/auth/[...nextauth]` - NextAuth endpoints
- `POST /api/auth/verify-establishment` - V√©rification √©tablissement
- `POST /api/verify-phone` - V√©rification SMS
- `POST /api/check-email` - V√©rification disponibilit√© email
- `POST /api/check-siret` - V√©rification SIRET

### Cat√©gories
- `GET /api/categories` - Liste des cat√©gories avec compteurs
- `GET /api/categories?q=ville` - Filtrage par ville

### √âtablissements
- `GET /api/etablissements` - Liste des √©tablissements
- `POST /api/etablissements` - Cr√©er un √©tablissement
- `PUT /api/etablissements/[slug]` - Modifier un √©tablissement
- `DELETE /api/etablissements/[slug]` - Supprimer un √©tablissement
- `GET /api/etablissements/[slug]/events` - √âv√©nements d'un √©tablissement
- `POST /api/etablissements/enrich` - Enrichir via Google Places
- `GET /api/etablissements/[slug]/images` - Images d'un √©tablissement
- `POST /api/etablissements/create-admin` - Cr√©ation admin d'√©tablissement
- `GET /api/establishments/all` - Tous les √©tablissements (admin)
- `GET /api/establishments/random` - √âtablissements al√©atoires
- `POST /api/establishments/correct-type` - Correction type d'√©tablissement
- `POST /api/establishments/suggest-type` - Suggestion type d'√©tablissement
- `POST /api/establishments/save-pattern` - Sauvegarde pattern d'apprentissage

### Recherche
- `GET /api/recherche/envie` - Recherche "envie" intelligente
- `GET /api/recherche/filtered` - Recherche avec filtres et pagination
- `GET /api/geocode` - G√©ocodage d'adresses
- `POST /api/google-places-proxy` - Proxy Google Places
- `POST /api/resolve-google-url` - R√©solution URL Google

### Dashboard Professionnel
- `GET /api/dashboard/stats` - Statistiques dashboard
- `GET /api/dashboard/establishments` - √âtablissements utilisateur
- `GET /api/dashboard/events` - √âv√©nements utilisateur
- `POST /api/dashboard/events` - Cr√©er un √©v√©nement
- `PUT /api/dashboard/events/[id]` - Modifier un √©v√©nement
- `DELETE /api/dashboard/events/[id]` - Supprimer un √©v√©nement
- `GET /api/dashboard/images` - Images utilisateur
- `POST /api/dashboard/images` - Upload d'images
- `PUT /api/dashboard/images/[id]` - Modifier une image
- `DELETE /api/dashboard/images/[id]` - Supprimer une image
- `POST /api/dashboard/images/reorder` - R√©organiser les images
- `POST /api/dashboard/images/set-card-image` - D√©finir image principale
- `POST /api/dashboard/change-password` - Changer mot de passe

### Bons Plans Journaliers
- `GET /api/deals/all` - Tous les bons plans actifs
- `POST /api/deals` - Cr√©er un bon plan
- `GET /api/deals/[establishmentId]` - Bons plans d'un √©tablissement
- `PUT /api/deals/[dealId]` - Modifier un bon plan
- `DELETE /api/deals/[dealId]` - Supprimer un bon plan
- `GET /api/deals/active/[establishmentId]` - Bon plan actif du jour
- `GET /api/deals/by-establishment/[establishmentId]` - Bons plans par √©tablissement
- `POST /api/deals/engagement` - Engagement sur un bon plan
- `POST /api/deals/recurrence/process` - Traitement r√©currence
- `POST /api/upload/deal-media` - Upload images/PDFs bons plans

### √âv√©nements
- `GET /api/events/upcoming` - √âv√©nements √† venir
- `POST /api/events/[eventId]/engage` - Engagement sur un √©v√©nement

### Messagerie
- `GET /api/messaging/conversations` - Liste des conversations
- `POST /api/messaging/conversations` - Cr√©er une conversation
- `GET /api/messaging/conversations/[id]` - D√©tails d'une conversation
- `POST /api/messaging/conversations/[id]/messages` - Envoyer un message
- `PATCH /api/messaging/conversations/[id]/read` - Marquer comme lu
- `PATCH /api/messaging/conversations/[id]/status` - Changer le statut
- `GET /api/messaging/unread-count` - Compter les messages non lus

### Analytics et Monitoring
- `GET /api/analytics/track` - Tracking des interactions
- `GET /api/analytics/search` - Analytics de recherche
- `POST /api/analytics/search/track` - Tracking recherche
- `GET /api/analytics/detailed` - Analytics d√©taill√©es
- `GET /api/monitoring/health` - Sant√© de l'application
- `GET /api/monitoring/liveness` - V√©rification de vie
- `GET /api/monitoring/readiness` - V√©rification de disponibilit√©
- `GET /api/monitoring/metrics` - M√©triques de performance

### Administration
- `GET /api/admin/stats` - Statistiques globales
- `GET /api/admin/metrics` - M√©triques admin
- `GET /api/admin/pending-count` - Compteur en attente
- `GET /api/admin/establishments` - Gestion √©tablissements
- `POST /api/admin/establishments/actions` - Actions sur √©tablissements
- `GET /api/admin/professionals` - Liste des professionnels
- `POST /api/admin/actions` - Actions admin g√©n√©rales
- `POST /api/admin/cleanup-images` - Nettoyage images orphelines
- `GET /api/admin/learning/patterns` - Patterns d'apprentissage
- `POST /api/admin/learning/validate` - Valider un pattern
- `POST /api/admin/learning/correct` - Corriger un pattern
- `DELETE /api/admin/learning/delete` - Supprimer un pattern
- `GET /api/admin/learning/stats` - Statistiques d'apprentissage
- `GET /api/admin/newsletter/subscribers` - Abonn√©s newsletter
- `GET /api/admin/newsletter/stats` - Statistiques newsletter
- `POST /api/admin/newsletter/toggle` - Activer/d√©sactiver abonnement
- `DELETE /api/admin/newsletter/delete` - Supprimer abonnement
- `GET /api/admin/newsletter/export` - Export newsletter
- `POST /api/admin/review-update` - Mise √† jour avis

### Professionnels
- `POST /api/professional-registration` - Inscription professionnel
- `GET /api/professional/establishment` - √âtablissement du professionnel
- `POST /api/professional/request-update` - Demande de mise √† jour
- `POST /api/professional/send-verification-sms` - Envoi SMS v√©rification
- `POST /api/professional/verify-sms-code` - V√©rification code SMS
- `POST /api/professional/verify-email` - V√©rification email
- `GET /api/professional/update-requests` - Demandes de mise √† jour

### Utilisateurs
- `GET /api/user/favorites` - Favoris utilisateur
- `POST /api/user/favorites/[id]` - Ajouter aux favoris
- `DELETE /api/user/favorites/[id]` - Retirer des favoris
- `GET /api/user/comments` - Commentaires utilisateur
- `POST /api/user/comments` - Cr√©er un commentaire
- `PUT /api/user/comments/[id]` - Modifier un commentaire
- `DELETE /api/user/comments/[id]` - Supprimer un commentaire
- `POST /api/user/update-profile` - Mettre √† jour le profil
- `POST /api/user/delete-account` - Supprimer le compte
- `GET /api/user/gamification` - Donn√©es de gamification
- `POST /api/user/location-preferences` - Pr√©f√©rences de localisation

### Commentaires et Signalements
- `POST /api/comments/[id]/reply` - R√©pondre √† un commentaire
- `POST /api/comments/[id]/report` - Signaler un commentaire

### Upload et M√©dias
- `POST /api/upload/image` - Upload d'images
- `POST /api/upload/optimized-image` - Upload d'images optimis√©es
- `POST /api/upload/event-image` - Upload d'images d'√©v√©nements
- `POST /api/upload/deal-media` - Upload m√©dias bons plans

### S√©curit√©
- `GET /api/csrf/token` - Token CSRF

### Newsletter
- `POST /api/newsletter/subscribe` - S'abonner √† la newsletter
- `POST /api/newsletter/unsubscribe` - Se d√©sabonner

### Menus et Documents
- `GET /api/public/establishments/[slug]/menus` - Menus publics
- `GET /api/establishments/[id]/menus` - Menus d'√©tablissement
- `POST /api/establishments/[id]/menus` - Cr√©er un menu
- `GET /api/establishments/[id]/menus/[menuId]` - D√©tails d'un menu
- `PUT /api/establishments/[id]/menus/[menuId]` - Modifier un menu
- `DELETE /api/establishments/[id]/menus/[menuId]` - Supprimer un menu
- `POST /api/establishments/[id]/menus/upload` - Upload de menus PDF

#### Exemples d'utilisation API Recherche Filtr√©e
```bash
# Recherche "escape" √† Paris avec filtre populaire
GET /api/recherche/filtered?envie=escape&ville=Paris&filter=popular&page=1&limit=15

# Recherche "vr" √† Dijon avec filtre "Les - cher"
GET /api/recherche/filtered?envie=vr&ville=Dijon&filter=cheap&page=1&limit=15

# Filtre "Notre s√©lection" (√©tablissements premium uniquement)
GET /api/recherche/filtered?envie=restaurant&ville=Lyon&filter=premium&page=1&limit=15

# Pagination - page 2
GET /api/recherche/filtered?envie=bar&ville=Marseille&filter=popular&page=2&limit=15
```

#### Param√®tres API Recherche
- `envie` (requis) : Terme de recherche
- `ville` : Ville de recherche (optionnel)
- `filter` : Type de filtre (popular, wanted, cheap, premium, newest, rating)
- `page` : Num√©ro de page (d√©faut: 1)
- `limit` : Nombre de r√©sultats par page (d√©faut: 15)
- `lat`/`lng` : Coordonn√©es GPS (optionnel)

## üéØ Fonctionnalit√©s R√©centes

### ‚úÖ Syst√®me d'Authentification Complet
- [x] NextAuth.js avec support multi-providers
- [x] Gestion des r√¥les (Admin, Professionnel, Utilisateur)
- [x] Protection des routes avec middleware
- [x] Hydratation de session optimis√©e
- [x] V√©rification SMS pour les professionnels
- [x] Suppression de compte utilisateur

### ‚úÖ Espaces Utilisateurs Avanc√©s
- [x] Dashboard professionnel complet avec analytics
- [x] Espace admin refait avec gestion compl√®te
- [x] Profil utilisateur avec favoris et pr√©f√©rences
- [x] Inscription simplifi√©e (compte + √©tablissement)
- [x] Gestion des pr√©f√©rences de localisation
- [x] Syst√®me de badges et gamification

### ‚úÖ Syst√®me d'Enrichissement Intelligent
- [x] Int√©gration Google Places API
- [x] Enrichissement automatique des donn√©es
- [x] Syst√®me hybride (auto + manuel)
- [x] Protection des donn√©es manuelles
- [x] Syst√®me de learning patterns pour am√©liorer l'enrichissement
- [x] Suggestions automatiques de type d'√©tablissement

### ‚úÖ Carte Interactive Avanc√©e
- [x] Marqueurs personnalis√©s
- [x] Popups adaptatifs selon le contexte
- [x] Marqueur de recherche central
- [x] Syst√®me de r√©glages facile
- [x] G√©olocalisation am√©lior√©e avec historique des villes

### ‚úÖ Syst√®me d'√âv√©nements et Engagement
- [x] Gestion compl√®te des √©v√©nements
- [x] Filtrage temporel intelligent
- [x] Interface utilisateur intuitive
- [x] Syst√®me de likes/dislikes pour les √©v√©nements
- [x] Statistiques d'engagement en temps r√©el
- [x] Gauge d'engagement visuelle

### ‚úÖ Design Responsive Optimis√©
- [x] Largeur adaptative pour √©crans larges
- [x] Syst√®me de r√©glages de tailles
- [x] Layout optimis√© multi-√©crans
- [x] Mode mobile-first avec navigation optimis√©e

### ‚úÖ Syst√®me de Filtres et Pagination
- [x] 6 filtres intelligents avec ic√¥nes Lucide
- [x] Pagination infinie "Voir plus" (15 r√©sultats/page)
- [x] Filtre "Notre s√©lection" (√©tablissements premium)
- [x] API de recherche filtr√©e avec tri dynamique
- [x] Interface utilisateur intuitive et responsive
- [x] Compatible avec g√©olocalisation existante

#### üéØ Filtres Disponibles
1. **Populaire** - Tri par nombre de vues (`viewsCount`)
2. **D√©sir√©s ++** - Tri par nombre de likes (`likesCount`)
3. **Les - cher** - Tri par prix croissant (`priceMin`)
4. **Notre s√©lection** - √âtablissements premium uniquement (`subscription = 'PREMIUM'`)
5. **Nouveaux** - Tri par date de cr√©ation (`createdAt`)
6. **Mieux not√©s** - Tri par note moyenne (`avgRating`)

#### üìÑ Pagination Intelligente
- **15 r√©sultats par page** par d√©faut
- **Bouton "Voir plus"** avec √©tats de chargement
- **Compteur dynamique** : "X affich√©s sur Y total"
- **Chargement progressif** sans rechargement de page
- **Compatible avec tous les filtres**

### üéØ Syst√®me de Bons Plans Journaliers (NOUVEAU)
- [x] **Dashboard Premium** : Cr√©ation et gestion des bons plans
- [x] **Programmation** : Dates et horaires avec activation automatique
- [x] **Upload multim√©dia** : Images et PDFs pour les offres
- [x] **Affichage intelligent** : Modal automatique + card permanente
- [x] **Page d√©di√©e** : `/bons-plans` avec carousel et grille
- [x] **Redirection fluide** : Clic ‚Üí √©tablissement concern√©
- [x] **Design coh√©rent** : Bordure orange n√©on sur fond blanc cr√®me
- [x] **API compl√®te** : `/api/deals/*` pour toutes les op√©rations

### üí¨ Syst√®me de Messagerie Pro-Admin (NOUVEAU)
- [x] **Communication bidirectionnelle** : Professionnels ‚Üî Administrateurs
- [x] **Interface compl√®te** : Liste des conversations avec filtres
- [x] **Badges de notification** : Compteur de messages non lus
- [x] **Polling automatique** : Mise √† jour toutes les 30 secondes
- [x] **Gestion des statuts** : Conversations ouvertes/ferm√©es
- [x] **Pages d√©di√©es** : `/dashboard/messagerie` et `/admin/messagerie`
- [x] **S√©curit√©** : Permissions strictes et validation des donn√©es

### üìä Analytics et Monitoring Avanc√©s (NOUVEAU)
- [x] **Dashboard analytics** : Statistiques d√©taill√©es pour les professionnels
- [x] **Tracking des clics** : Suivi des interactions utilisateurs
- [x] **Monitoring de sant√©** : Endpoints `/api/monitoring/*`
- [x] **M√©triques de performance** : Temps de r√©ponse et logs
- [x] **Analytics de recherche** : Tracking des requ√™tes et r√©sultats
- [x] **Statistiques d'engagement** : Likes, vues, favoris

### üîí S√©curit√© Renforc√©e (NOUVEAU)
- [x] **Protection CSRF** : Tokens et validation c√¥t√© serveur
- [x] **Rate limiting √©tendu** : Protection contre les abus
- [x] **Validation stricte** : Sanitisation des entr√©es utilisateur
- [x] **Protection XSS/SQL** : Tests de s√©curit√© complets
- [x] **Tests de p√©n√©tration** : Suite de tests de s√©curit√© automatis√©s
- [x] **Audit de s√©curit√©** : Logs et monitoring des tentatives d'intrusion

### üè¢ Administration Compl√®te (NOUVEAU)
- [x] **Interface admin refaite** : Design moderne et intuitif
- [x] **Gestion des √©tablissements** : Analytics et mod√©ration
- [x] **Syst√®me de learning** : Patterns d'am√©lioration automatique
- [x] **Gestion newsletter** : Abonn√©s et campagnes
- [x] **Mod√©ration** : Commentaires et signalements
- [x] **Statistiques globales** : Vue d'ensemble de la plateforme

### üìÑ Pages L√©gales et Support (NOUVEAU)
- [x] **Pages l√©gales** : CGV, conditions, mentions l√©gales
- [x] **Support utilisateur** : Page de contact et FAQ
- [x] **D√©sinscription** : Page d√©di√©e pour la newsletter
- [x] **√Ä propos** : Pr√©sentation de la plateforme
- [x] **Politique de confidentialit√©** : Conformit√© RGPD

### üß™ Tests et Qualit√© (NOUVEAU)
- [x] **Suite de tests compl√®te** : 120+ tests unitaires et d'int√©gration
- [x] **Tests E2E** : Playwright pour les parcours utilisateurs
- [x] **Tests de s√©curit√©** : Validation contre les attaques courantes
- [x] **Tests de performance** : Mesure des temps de r√©ponse
- [x] **Coverage de code** : Rapport de couverture des tests
- [x] **Tests de r√©gression** : Pr√©vention des r√©gressions

## üîí S√©curit√© et Qualit√©

### Protection CSRF
- **Tokens CSRF** : G√©n√©ration et validation automatique
- **Middleware de protection** : Validation c√¥t√© serveur
- **Endpoints s√©curis√©s** : `/api/csrf/token` pour r√©cup√©rer les tokens

### Rate Limiting
- **Protection contre les abus** : Limitation des requ√™tes par IP
- **Endpoints prot√©g√©s** : Upload, authentification, recherche
- **Configuration flexible** : Limites adapt√©es par type d'op√©ration

### Validation et Sanitisation
- **Validation stricte** : Tous les inputs utilisateur sont valid√©s
- **Sanitisation XSS** : Protection contre les injections de scripts
- **Validation SQL** : Protection contre les injections SQL via Prisma
- **Caract√®res sp√©ciaux** : Support Unicode et √©mojis s√©curis√©

### Tests de S√©curit√©
- **Suite de tests compl√®te** : 60+ tests de s√©curit√© automatis√©s
- **Tests de p√©n√©tration** : Validation contre les attaques courantes
- **Tests d'injection** : SQL, XSS, et autres vecteurs d'attaque
- **Tests d'autorisation** : V√©rification des permissions

## üß™ Tests et Qualit√©

### Couverture de Tests
- **120+ tests unitaires** : Couverture compl√®te des fonctionnalit√©s
- **Tests d'int√©gration** : Validation des flux complets
- **Tests E2E** : Parcours utilisateurs avec Playwright
- **Tests de performance** : Mesure des temps de r√©ponse

### Types de Tests
- **Tests de s√©curit√©** : Protection contre les attaques
- **Tests de performance** : Optimisation des requ√™tes
- **Tests de r√©gression** : Pr√©vention des bugs
- **Tests d'accessibilit√©** : Conformit√© aux standards

### Outils de Test
- **Jest** : Tests unitaires et d'int√©gration
- **Playwright** : Tests E2E avec navigateurs r√©els
- **Coverage** : Rapport de couverture de code
- **CI/CD** : Int√©gration continue avec GitHub Actions

## üìä Monitoring et Analytics

### Monitoring de Sant√©
- **Endpoints de sant√©** : `/api/monitoring/health`
- **V√©rifications de vie** : `/api/monitoring/liveness`
- **V√©rifications de disponibilit√©** : `/api/monitoring/readiness`
- **M√©triques de performance** : `/api/monitoring/metrics`

### Analytics Utilisateur
- **Tracking des clics** : Suivi des interactions utilisateurs
- **Analytics de recherche** : Requ√™tes et r√©sultats populaires
- **Statistiques d'engagement** : Likes, vues, favoris
- **Dashboard analytics** : Interface pour les professionnels

### Logs et Debugging
- **Logs structur√©s** : Format JSON pour faciliter l'analyse
- **Niveaux de log** : Error, Warning, Info, Debug
- **Corr√©lation des requ√™tes** : Tra√ßabilit√© des actions utilisateur
- **Monitoring des erreurs** : D√©tection automatique des probl√®mes

## üéØ Fonctionnalit√©s √† Venir

### Court Terme (Q1 2025)
- [ ] **Syst√®me de r√©servation en ligne** : Int√©gration avec calendriers et paiements
- [ ] **Notifications push et email** : Alertes temps r√©el pour les utilisateurs
- [ ] **Mode sombre/clair** : Th√®me adaptatif selon les pr√©f√©rences
- [ ] **Application mobile PWA** : Version mobile native

### Moyen Terme (Q2-Q3 2025)
- [ ] **Int√©gration paiements** : Stripe/PayPal pour les r√©servations
- [ ] **Syst√®me d'avis avanc√©** : Reviews d√©taill√©es avec photos
- [ ] **Chat en temps r√©el** : WebSocket pour la messagerie instantan√©e
- [ ] **Recommandations IA** : Suggestions personnalis√©es bas√©es sur l'historique
- [ ] **Syst√®me de fid√©lit√©** : Points et r√©compenses pour les utilisateurs

### Long Terme (Q4 2025+)
- [ ] **API publique** : Ouverture pour les partenaires tiers
- [ ] **Marketplace** : Plateforme pour les services compl√©mentaires
- [ ] **Intelligence artificielle** : Chatbot et assistance automatique
- [ ] **Reality augment√©e** : Visite virtuelle des √©tablissements
- [ ] **Blockchain** : Syst√®me de r√©putation d√©centralis√©

### Am√©liorations Techniques
- [ ] **Cache Redis** : Optimisation des performances
- [ ] **CDN global** : Distribution mondiale du contenu
- [ ] **Microservices** : Architecture distribu√©e
- [ ] **Kubernetes** : Orchestration des conteneurs
- [ ] **Monitoring avanc√©** : APM et alertes proactives

## ü§ù Contribution

1. Fork le projet
2. Cr√©er une branche feature (`git checkout -b feature/AmazingFeature`)
3. Commit les changements (`git commit -m 'Add some AmazingFeature'`)
4. Push vers la branche (`git push origin feature/AmazingFeature`)
5. Ouvrir une Pull Request

## üìÑ Licence

Ce projet est sous licence MIT. Voir le fichier `LICENSE` pour plus de d√©tails.

## üìû Contact

- **D√©veloppeur** : Vivien Bernardot
- **Projet** : Envie2Sortir
- **GitHub** : [voicedhealer/envie2sortir](https://github.com/voicedhealer/envie2sortir)

---

## üìà Mise √† Jour du README (Janvier 2025)

### ‚úÖ Nouvelles Fonctionnalit√©s Document√©es
- **üéØ Syst√®me de Bons Plans Journaliers** : Gestion compl√®te pour les √©tablissements Premium
- **üí¨ Syst√®me de Messagerie Pro-Admin** : Communication bidirectionnelle avec notifications
- **üìä Analytics et Monitoring Avanc√©s** : Tracking et m√©triques de performance
- **üîí S√©curit√© Renforc√©e** : Protection CSRF, rate limiting, tests de s√©curit√©
- **üè¢ Administration Compl√®te** : Interface admin refaite avec analytics
- **üìÑ Pages L√©gales et Support** : CGV, FAQ, contact, conformit√© RGPD
- **üß™ Tests et Qualit√©** : 120+ tests avec couverture compl√®te

### üìã API Endpoints Mis √† Jour
- **80+ endpoints** document√©s et organis√©s par cat√©gorie
- **Nouvelles routes** : Bons plans, messagerie, analytics, monitoring
- **Exemples d'utilisation** : Param√®tres et cas d'usage d√©taill√©s
- **Documentation compl√®te** : Authentification, upload, s√©curit√©

### üîß Sections Techniques Ajout√©es
- **S√©curit√© et Qualit√©** : CSRF, rate limiting, validation, tests
- **Tests et Qualit√©** : Couverture, outils, types de tests
- **Monitoring et Analytics** : Sant√©, logs, m√©triques de performance
- **Fonctionnalit√©s √† Venir** : Roadmap organis√©e par √©ch√©ances

### üìä Statistiques du Projet
- **Technologies** : Next.js 15, React 19, TypeScript, Prisma, SQLite
- **Tests** : 120+ tests unitaires, E2E, s√©curit√©, performance
- **API** : 80+ endpoints organis√©s en 15 cat√©gories
- **Fonctionnalit√©s** : 50+ fonctionnalit√©s impl√©ment√©es et document√©es

---

**Envie2Sortir** - D√©couvrez toutes vos envies, pr√®s de chez vous ! üéâ